# ๐ฆ Data Backup & Restore

ุงู ุงุณฺฉุฑูพุชโูุง ุจุฑุง ูพุดุชุจุงูโฺฏุฑ ู ุจุงุฒุงุจ ุชูุงู ุฏุงุฏูโูุง ุงูพูฺฉุดู ุทุฑุงุญ ุดุฏูโุงูุฏ.

## ๐ฏ ููุงุฑุฏ ุงุณุชูุงุฏู

- ูพุดุชุจุงูโฺฏุฑ ููุธู ุงุฒ ุฏุงุฏูโูุง
- ุงูุชูุงู ุฏุงุฏูโูุง ุจู ูุญุทโูุง ูุฎุชูู (development, staging, production)
- ุจุงุฒุงุจ ุณุฑุน ุฏุฑ ุตูุฑุช ูุดฺฉู
- ุงุฌุงุฏ seed data ุจุฑุง ุชูุณุนู ู ุชุณุช

## ๐ฅ Export (ูพุดุชุจุงูโฺฏุฑ)

### ุฏุณุชูุฑ:
```bash
npm run data:export
```

### ุนููฺฉุฑุฏ:
- ุชูุงู ุฏุงุฏูโูุง ุฏุชุงุจุณ ุฑุง export ูโฺฉูุฏ
- ูุงู JSON ุฏุฑ `prisma/backups/` ุฐุฎุฑู ูโุดูุฏ
- ฺฉ ูุณุฎู `latest.json` ุจุฑุง ุฏุณุชุฑุณ ุขุณุงู ุงุฌุงุฏ ูโฺฉูุฏ
- ุขูุงุฑ ฺฉุงูู ุฏุงุฏูโูุง ุฑุง ููุงุด ูโุฏูุฏ

### ุฎุฑูุฌ:
```
prisma/backups/
โโโ backup-2026-01-28T10-30-00-000Z.json
โโโ backup-2026-01-29T15-45-30-000Z.json
โโโ latest.json (symlink to latest backup)
```

## ๐ค Import (ุจุงุฒุงุจ)

### ุฏุณุชูุฑ:
```bash
# ุงุณุชูุงุฏู ุงุฒ ุขุฎุฑู backup
npm run data:import

# ุงุณุชูุงุฏู ุงุฒ backup ุฎุงุต
npm run data:import backup-2026-01-28T10-30-00-000Z.json
```

### โ๏ธ ูุดุฏุงุฑ:
- ุชูุงู ุฏุงุฏูโูุง ููุฌูุฏ ุฏุฑ ุฏุชุงุจุณ **ุญุฐู** ูโุดูุฏ
- 5 ุซุงูู ูุฑุตุช ูุบู ุฏุงุฑุฏ (Ctrl+C)
- ูุจู ุงุฒ import ุญุชูุงู backup ุจฺฏุฑุฏ

### ุนููฺฉุฑุฏ:
1. ุจุงุฑฺฏุฐุงุฑ ูุงู backup
2. ุญุฐู ุชูุงู ุฏุงุฏูโูุง ููุฌูุฏ
3. import ุฏุงุฏูโูุง ุฌุฏุฏ ุจู ุชุฑุชุจ ุตุญุญ
4. ููุงุด ฺฏุฒุงุฑุด ฺฉุงูู

## ๐ ุฏุงุฏูโูุง ูพุดุชุจุงู ุดุฏู

- โ ฺฉุงุฑุจุฑุงู ู ุงุญุฑุงุฒ ููุช
- โ ุจุฎุดโูุง ู ุณุงุฒูุงู
- โ ูุฏุจฺฉโูุง ู ูพุงูโูุง
- โ ูุธุงู ู ุชุฎุตุตโูุง
- โ ุขุฒูููโูุง ู ูุชุงุฌ
- โ ุงุนูุงูุงุช ู ูุธุฑุณูุฌโูุง
- โ ูพุฑูฺูโูุง ู ูุงูโูุง
- โ ุจูโุฑูุฒุฑุณุงูโูุง ู ุงุนูุงูโูุง
- โ ุชูุธูุงุช ุณุณุชู

## ๐ Workflow ูพุดููุงุฏ

### ูพุดุชุจุงูโฺฏุฑ ุฑูุฒุงูู:
```bash
# ูุฑ ุฑูุฒ ฺฉ backup ุจฺฏุฑุฏ
npm run data:export
```

### ุงูุชูุงู ุฏุงุฏู ุจู ุณุฑูุฑ ุฌุฏุฏ:
```bash
# ุฏุฑ ุณุฑูุฑ ูุฏู
npm run data:export

# ฺฉูพ ูุงู ุจู ุณุฑูุฑ ุฌุฏุฏ
scp prisma/backups/latest.json user@newserver:/path/to/app/prisma/backups/

# ุฏุฑ ุณุฑูุฑ ุฌุฏุฏ
npm run data:import latest.json
```

### ุจุงุฒุงุจ ุจุนุฏ ุงุฒ ูุดฺฉู:
```bash
# ูุณุช backupูุง
ls -lh prisma/backups/

# ุงูุชุฎุงุจ backup ููุฑุฏ ูุธุฑ
npm run data:import backup-2026-01-28T10-30-00-000Z.json
```

## ๐ก ูฺฉุงุช ููู

1. **ูุงูโูุง ุขูพููุฏ ุดุฏู**: ุงู backup ููุท ุฏุงุฏูโูุง ุฏุชุงุจุณ ุฑุง ุฐุฎุฑู ูโฺฉูุฏ. ุจุฑุง ูุงูโูุง ุขูพููุฏ ุดุฏู (`public/uploads/`) ุจุงุฏ ุฌุฏุงฺฏุงูู backup ุจฺฏุฑุฏ.

2. **ุฑูุฒูุง ุนุจูุฑ**: ุฑูุฒูุง hash ุดุฏู ุฐุฎุฑู ูโุดููุฏุ ูพุณ ุจุนุฏ ุงุฒ restore ููุงู ุฑูุฒูุง ูุจู ฺฉุงุฑ ูโฺฉููุฏ.

3. **ID ูุง**: ุชูุงู ID ูุง ุญูุธ ูโุดููุฏุ ูพุณ ุฑูุงุจุท ุจู ุฌุฏุงูู ุฏุณุช ูุฎูุฑุฏู ุจุงู ูโูุงูุฏ.

4. **Object Storage**: ุงฺฏุฑ ุงุฒ MinIO ุงุณุชูุงุฏู ูโฺฉูุฏุ ุจุงุฏ bucket ูุง ุฑุง ุฌุฏุงฺฏุงูู backup ฺฉูุฏ.

## ๐ ุงููุช

- ูุงูโูุง backup ุญุงู ุงุทูุงุนุงุช ุญุณุงุณ ูุณุชูุฏ
- ุฏุฑ `.gitignore` ุงุถุงูู ุดุฏูโุงูุฏ
- ูุจู ุงุฒ ุงุดุชุฑุงฺฉโฺฏุฐุงุฑุ ุฑูุฒูุง ุนุจูุฑ ุฑุง ุจุฑุฑุณ ฺฉูุฏ
- ุจุฑุง production ุงุฒ encryption ุงุณุชูุงุฏู ฺฉูุฏ

## ๐ ุณุงุฎุชุงุฑ ูุงู Backup

```json
{
  "exportDate": "2026-01-28T10:30:00.000Z",
  "version": "1.0.0",
  "data": {
    "users": [...],
    "departments": [...],
    "feedbacks": [...],
    ...
  }
}
```

## ๐ ุนุจโุงุจ

### ุฎุทุง "File not found":
```bash
# ูุณุช backupูุง
ls -lh prisma/backups/
```

### ุฎุทุง Prisma:
```bash
# ุจุงุฒุชููุฏ Prisma Client
npm run db:generate
```

### ุฎุทุง ุฏุณุชุฑุณ:
```bash
# ุจุฑุฑุณ ุฏุณุชุฑุณโูุง
chmod +x scripts/export-data.ts
chmod +x scripts/import-data.ts
```
